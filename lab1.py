# ==========================================================
#                 ЗАДАНИЕ 1. Работа с текстом
# ==========================================================
# Условие:
# 1. Написать функцию, которая принимает строку, возвращает словарь,
#    где ключи - уникальные слова, а значения - их количество.
# 2. Создать и вывести на экран список, где хранятся слова,
#    которые встречаются более 3 раз.
# ----------------------------------------------------------

def word_count(text: str) -> dict:
    """
    Принимает строку и подсчитывает частоту каждого слова.
    """
    # Приводим текст к нижнему регистру и разбиваем на слова
    words = text.lower().split()
    counts = {}
    for word in words:
        counts[word] = counts.get(word, 0) + 1
    return counts

def get_frequent_words(text: str) -> list:
    """
    Возвращает список слов, которые встречаются в тексте более 3 раз.
    """
    counts = word_count(text)
    # Используем списковое включение для фильтрации
    return [word for word, count in counts.items() if count > 3]


# ==========================================================
#        ЗАДАНИЕ 2. Инвентаризация продуктов
# ==========================================================
# Условие:
# 1. Создать словарь продуктов (ключ - название, значение - количество).
# 2. Написать функцию, которая принимает название продукта и количество
#    и обновляет словарь (добавляет или изменяет).
# 3. Дополнительно: создать список продуктов, в которых количество меньше 5.
# ----------------------------------------------------------

# Изначальный словарь с продуктами
products = {
    "яблоки": 10,
    "бананы": 8,
    "молоко": 4, # <-- Этого меньше 5
    "хлеб": 1,   # <-- И этого
    "апельсины": 15
}

def update_product_stock(product_name: str, quantity: int):
    """
    Обновляет количество указанного продукта на складе.
    Если продукта нет, он будет добавлен.
    """
    products[product_name] = quantity
    print(f"-> Информация о продукте '{product_name}' обновлена. Новое количество: {quantity}.")

def get_low_stock_products() -> list:
    """
    Возвращает список продуктов, количество которых МЕНЬШЕ 5.
    (ИСПРАВЛЕНО: было c > 5, стало c < 5)
    """
    return [product for product, count in products.items() if count < 5]


# ==========================================================
#        ЗАДАНИЕ 4. Система управления задачами
# ==========================================================
# Условие:
# 1. Создать словарь, где ключ - название задачи, значение - статус
#    ("выполнено", "в процессе", "ожидает").
# 2. Написать функции для добавления, удаления и изменения статуса задач.
# 3. Дополнительно: создать список задач, которые имеют статус "ожидает".
# ----------------------------------------------------------

# Изначальный словарь задач
tasks = {}

def add_task(task_name: str):
    """
    Добавляет новую задачу со статусом "ожидает".
    """
    if task_name not in tasks:
        tasks[task_name] = "ожидает"
        print(f"-> Задача '{task_name}' добавлена.")
    else:
        print(f"-> Задача '{task_name}' уже существует.")

def remove_task(task_name: str):
    """
    Удаляет задачу из словаря.
    (ДОБАВЛЕНО: этой функции не хватало по условию)
    """
    if task_name in tasks:
        del tasks[task_name]
        print(f"-> Задача '{task_name}' удалена.")
    else:
        print(f"-> Задача '{task_name}' не найдена.")

def change_task_status(task_name: str, new_status: str):
    """
    Изменяет статус существующей задачи.
    """
    if task_name in tasks:
        tasks[task_name] = new_status
        print(f"-> Статус задачи '{task_name}' изменен на '{new_status}'.")
    else:
        print(f"-> Задача '{task_name}' не найдена.")

def get_pending_tasks() -> list:
    """
    Возвращает список задач со статусом "ожидает".
    """
    return [task for task, status in tasks.items() if status == "ожидает"]


# ==========================================================
#              БЛОК ПРОВЕРКИ И ДЕМОНСТРАЦИИ
# ==========================================================

print("--- ЗАДАНИЕ 1: Проверка ---")
test_text = "слово раз слово два слово три слово четыре слово пять"
print(f"Исходный текст: '{test_text}'")
print("Словарь с подсчетом:", word_count(test_text))
print("Слова, которые встречаются > 3 раз:", get_frequent_words(test_text))
print("-" * 40)


print("\n--- ЗАДАНИЕ 2: Проверка ---")
print("Начальный склад:", products)
print("Продукты, которых меньше 5 шт:", get_low_stock_products())
update_product_stock("бананы", 3) # Уменьшаем количество бананов
update_product_stock("сок", 20)     # Добавляем новый продукт
print("Обновленный склад:", products)
print("Продукты, которых теперь меньше 5 шт:", get_low_stock_products())
print("-" * 40)


print("\n--- ЗАДАНИЕ 4: Проверка ---")
print("Начальный список задач:", tasks)
add_task("Сделать лабораторную")
add_task("Позвонить другу")
add_task("Купить продукты")
print("Задачи после добавления:", tasks)
change_task_status("Сделать лабораторную", "выполнено")
remove_task("Купить продукты")
print("Задачи после изменения статуса и удаления:", tasks)
print("Задачи в статусе 'ожидает':", get_pending_tasks())
print("-" * 40)